(this["webpackJsonppresence-client-app"]=this["webpackJsonppresence-client-app"]||[]).push([[0],{175:function(e,t,a){e.exports=a(327)},180:function(e,t,a){},238:function(e,t){},327:function(e,t,a){"use strict";a.r(t),a.d(t,"render",(function(){return Ot}));var n=a(0),r=a.n(n),c=a(9),i=a.n(c),o=(a(180),a(24)),l=a(36),s=a(359),u=a(328),m=a(384),p=a(16),d=a(362),g=a(364),f=a(58),h=a(365),E=a(160),v=a.n(E),b=a(368),O=a(165),y=a(19),S=a.n(y),j=a(34),U=a(56),C=a.n(U),N="app/auth/LOGIN_STARTED",w="app/auth/SIGN_UP_PENDING",I="app/auth/SIGN_UP_SUCCESS",_="app/auth/SIGN_UP_FAILURE",T="production";console.log("ENV: ",T);var x="Unable to register :( Please contact system admin if issue persists.",k=a(154),R=a.n(k),L=function(){var e;return{getSocket:function(){return e},create:function(){return e=R()("http://localhost:8000")},disconnect:function(){return e.disconnect()}}}(),G=a(10),A=a(155),P={Accept:"application/json","Content-Type":"application/json"},F=a.n(A).a.create({baseURL:"",headers:P});F.interceptors.request.use((function(e){return e}),(function(e){return console.info("Request ERROR::\n".concat(new Date," :: "),e),Promise.reject(e)})),F.interceptors.response.use((function(e){return e}),(function(e){return console.info("Response ERROR::\n".concat(new Date," :: "),e),Promise.reject(e)}));var D=function(e,t){return F(Object(G.a)({url:e},t,{withCredentials:!0,headers:Object(G.a)({},P)}))},H=function(){var e=Object(j.a)(S.a.mark((function e(t,a){var n,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Et.dispatch({type:N}),e.next=4,D("/session/login",{method:"POST",data:{username:t,password:a}});case 4:if(n=e.sent,"OK"!==(r=n.data).status){e.next=11;break}L.create(),Et.dispatch({type:"app/auth/LOGIN_SUCCESS",payload:r.data}),e.next=12;break;case 11:throw r;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),Et.dispatch({type:"app/auth/LOGIN_FAILURE",payload:e.t0});case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,a){return e.apply(this,arguments)}}(),V=function(){var e=Object(j.a)(S.a.mark((function e(t,a){var n,r,c,i=arguments;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]&&i[2],e.prev=1,Et.dispatch({type:w}),e.next=5,D("/users/register-user",{method:"PUT",data:{username:t,password:a,isAdmin:n}});case 5:if(r=e.sent,"OK"!==(c=r.data).status){e.next=11;break}Et.dispatch({type:I,payload:!0}),e.next=12;break;case 11:throw c;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),Et.dispatch({type:_,payload:C()(e.t0,"response.data.message",x)});case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,a){return e.apply(this,arguments)}}(),M=function(){var e=Object(j.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Et.dispatch({type:"app/auth/LOGIN_RESET"}),Et.dispatch({type:"app/auth/LOGOUT_PENDING"}),e.next=5,D("/session/logout",{method:"GET"});case 5:if(t=e.sent,"OK"!==(a=t.data).status){e.next=12;break}L.disconnect(),Et.dispatch({type:"app/auth/LOGOUT_SUCCESS",payload:!0}),e.next=13;break;case 12:throw a;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),Et.dispatch({type:"app/auth/LOGOUT_FAILURE"});case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(j.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Et.dispatch({type:"app/auth/FETCH_USER_HISTORY_PENDING"}),e.next=4,D("/users/history",{method:"GET"});case 4:if(t=e.sent,"OK"!==(a=t.data).status){e.next=10;break}Et.dispatch({type:"app/auth/FETCH_USER_HISTORY_SUCCESS",payload:a.data}),e.next=11;break;case 10:throw a;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),Et.dispatch({type:"app/auth/FETCH_USER_HISTORY_SUCCESS",payload:{}});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),q=Object(s.a)((function(e){return{container:{height:"100vh",margin:"auto 1em",textAlign:"center"},title:{flexGrow:1}}})),W=function(e){var t=q(),a=Object(l.g)(),c=Object(n.useState)(null),i=Object(p.a)(c,2),o=i[0],s=i[1],u=Boolean(o);return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{position:"static"},r.a.createElement(g.a,null,r.a.createElement(f.a,{variant:"h6",className:t.title},"User Presence"),e.isLoggedIn&&r.a.createElement("div",null,r.a.createElement(h.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){return s(e.currentTarget)},color:"inherit"},r.a.createElement(v.a,null)),r.a.createElement(O.a,{id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:u,onClose:function(){return s(null)}},e.admin&&r.a.createElement(b.a,{onClick:function(){a.push("/app/history")}},"User History"),r.a.createElement(b.a,{onClick:function(){a.push("/app"),M()}},"Logout"))))),r.a.createElement("main",{className:t.container},e.children))};W.defaultProps={isLoggedIn:!1,admin:!1};var Z=W,Y=a(383),K=a(369),B=a(370),J=Object(s.a)((function(){return{loginForm:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around",height:"26em"},field:{width:"75%"}}})),Q=function(e){var t=e.isSubmitting,a=e.onSubmit,c=J(),i=Object(n.useState)(""),l=Object(p.a)(i,2),s=l[0],u=l[1],m=Object(n.useState)(""),d=Object(p.a)(m,2),g=d[0],h=d[1];return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),a(e.target.elements)},className:c.loginForm},r.a.createElement("header",null,r.a.createElement(f.a,{variant:"h5"},"Welcome!"),r.a.createElement(f.a,{variant:"subtitle1"},"Please login to see more")),r.a.createElement(Y.a,{id:"username",label:"Username",variant:"outlined",className:c.field,required:!0,value:s,onChange:function(e){var t=e.target;return u(t.value)}}),r.a.createElement(Y.a,{id:"password",label:"Password",type:"password",variant:"outlined",className:c.field,required:!0,value:g,onChange:function(e){var t=e.target;return h(t.value)}}),t?r.a.createElement(K.a,null):r.a.createElement(B.a,{variant:"contained",type:"submit",disabled:t,color:"primary"},"Login"),r.a.createElement("footer",null,r.a.createElement(f.a,{variant:"subtitle2"},"Not registered yet? ",r.a.createElement(o.b,{to:"/app/register"},"Sign up"))))},X=Object(s.a)((function(){return{loginCtr:{margin:"8em auto",maxWidth:"32em"}}})),$=function(e){var t=e.loggingIn,a=e.loginFailure,n=e.signingUp,c=e.signUpSuccess,i=e.loggingOut,o=e.logoutSuccess,l=X(),s=!t&&a,p=!n&&c,d=!i&&o;return r.a.createElement(Z,null,r.a.createElement("section",{className:l.loginCtr},p&&r.a.createElement(m.a,{severity:"success"},"Registration successfull! Please login below"),d&&r.a.createElement(m.a,{severity:"success"},"Logout successful! Visit again!"),s&&r.a.createElement(m.a,{severity:"error"},"Invalid credientials. Please try again!"),r.a.createElement("br",null),r.a.createElement(u.a,{elevation:2},r.a.createElement(Q,{onSubmit:function(e){var t=e.username,a=e.password;H(t.value,a.value)},isSubmitting:t}))))},ee=a(385),te=a(44),ae=a.n(te),ne=a(372),re=a(373),ce=a(374),ie=a(375),oe=a(85),le=a(79),se=a(389),ue=a(387),me=a(45),pe=a.n(me),de=a(161),ge=a.n(de),fe=function(e){return ge()(e).format("ddd, MMM Do hA")},he=function(e){var t=e.username,a=e.lastVisited;return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,null,"Name: ",pe()(t)),r.a.createElement("em",null,"last online: ",fe(a)))},Ee=a(162),ve=a.n(Ee),be=a(371),Oe=a(163),ye=a.n(Oe),Se=a(81),je=function(e){var t=e.initial,a=e.admin,n=e.className,c=r.a.createElement(ue.a,{alt:"",className:n},ve()(t));return a?r.a.createElement(be.a,{overlap:"circle",anchorOrigin:{vertical:"top",horizontal:"left"},badgeContent:r.a.createElement(ye.a,{style:{color:Se.a[500]}})},c):c},Ue=Object(s.a)((function(){return ae()([ne.a,re.a,ce.a,ie.a,oe.a],(function(e){return{color:"white",backgroundColor:e[500]}}))})),Ce=Object(s.a)((function(){return{listCtr:{listStyleType:"none",display:"flex"},avatarCtr:{marginRight:"-0.75em"},lastAvatar:{color:"white",backgroundColor:le.a[500]},size:{height:"3em",width:"3em"}}})),Ne=r.a.memo((function(e){var t=e.users,a=e.hiddenCount,n=e.handleMore,c=Ue(),i=Ce();return r.a.createElement("ul",{className:i.listCtr},t.map((function(e,t){return r.a.createElement("li",{key:e.username,className:i.avatarCtr},r.a.createElement(se.a,{disableTouchListener:!0,title:r.a.createElement(he,e),arrow:!0},r.a.createElement("div",null,r.a.createElement(je,{initial:e.username[0],className:"".concat(c[t]," ").concat(i.size),admin:e.admin}))))})),a?r.a.createElement("li",{key:"last-item",className:i.avatarCtr,onClick:n},r.a.createElement(ue.a,{alt:"",className:"".concat(i.lastAvatar," ").concat(i.size)},"+",a)):null)})),we=a(78),Ie=a.n(we),_e=a(329),Te=a(380),xe=a(381),ke=a(367),Re=a(84),Le=a(376),Ge=a(83),Ae=a(82),Pe=a(377),Fe=a(80),De=a(378),He=a(379),Ve=[];Ie()(5,(function(){return Ve.push(oe.a,Re.a,Le.a,Ge.a,Ae.a,Pe.a,Fe.a,De.a,He.a)}));var Me=Object(s.a)((function(){return ae()(Ve,(function(e){return{color:"white",backgroundColor:e[500]}}))})),ze=function(e){var t=e.username,a=e.color,n=e.lastVisited,c=e.admin;return r.a.createElement(_e.a,null,r.a.createElement(Te.a,null,r.a.createElement(je,{initial:t[0],className:a,admin:c})),r.a.createElement(xe.a,{primary:pe()(t),secondary:r.a.createElement("em",null,"Last online: ".concat(fe(n)))}))},qe=function(e){var t=e.users,a=Me();return r.a.createElement(ke.a,null,t.map((function(e,t){return r.a.createElement(ze,Object.assign({key:e.username,color:a[t]},e))})))},We=Object(s.a)((function(){return{container:{height:"85%",display:"flex",alignItems:"center",justifyContent:"center"},modalWindow:{display:"flex",alignItems:"center",justifyContent:"center"},modalCtr:{width:"50%",overflow:"auto",maxHeight:"75%"}}})),Ze=function(e){var t=e.activeUsers,a=e.loggedInUser,c=We(),i=Object(n.useState)(!1),o=Object(p.a)(i,2),l=o[0],s=o[1],m=C()(a,"isAdmin",!1),d=t.slice(0,5),g=t.slice(5);return r.a.createElement(Z,{isLoggedIn:!0,admin:m},r.a.createElement("section",{className:c.container},r.a.createElement(Ne,{users:d,hiddenCount:g.length,max:5,handleMore:function(){return s(!0)}}),r.a.createElement(ee.a,{open:l,onClose:function(){return s(!1)},className:c.modalWindow},r.a.createElement(u.a,{className:c.modalCtr},r.a.createElement(qe,{users:g})))))},Ye=function(e){var t=e.color,a=e.username,n=e.createdOn,c=e.lastVisited,i=e.isAdmin;return r.a.createElement(_e.a,null,r.a.createElement(Te.a,null,r.a.createElement(je,{initial:a[0],className:t,admin:i})),r.a.createElement(xe.a,{primary:pe()(a),secondary:r.a.createElement("em",null,"Created on: ".concat(fe(n)))}),r.a.createElement(xe.a,{style:{textAlign:"right"},primary:r.a.createElement("em",null,"Last online: ".concat(fe(c)))}))},Ke=[];Ie()(5,(function(){return Ke.push(oe.a,Re.a,Le.a,Ge.a,Ae.a,Pe.a,Fe.a,De.a,He.a)}));var Be,Je=Object(s.a)((function(){return ae()(Ke,(function(e){return{color:"white",backgroundColor:e[500]}}))})),Qe=Object(s.a)((function(){return{container:{marginTop:"1em",textAlign:"left"},title:{padding:"8px 16px"},center:{display:"flex",alignItems:"center",justifyContent:"center"}}})),Xe=function(e){var t=e.users,a=Je(),n=Qe();return t.length?r.a.createElement(Z,{isLoggedIn:!0},r.a.createElement("section",{className:n.container},r.a.createElement(f.a,{variant:"h4",color:"primary",className:n.title},"User History"),r.a.createElement(ke.a,null,t.map((function(e,t){return r.a.createElement(Ye,Object.assign({color:a[t]},e))}))))):r.a.createElement("section",{className:n.center},r.a.createElement(f.a,{variant:"h5"},"No history data"))},$e=a(382),et=a(388),tt=Object(s.a)((function(){return{registerForm:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around",height:"26em"},field:{width:"75%"}}})),at=function(e){var t=e.isSubmitting,a=e.onSubmit,c=tt(),i=Object(n.useState)(""),l=Object(p.a)(i,2),s=l[0],u=l[1],m=Object(n.useState)(""),d=Object(p.a)(m,2),g=d[0],h=d[1],E=Object(n.useState)(!1),v=Object(p.a)(E,2),b=v[0],O=v[1];return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),a(e.target.elements)},className:c.registerForm},r.a.createElement("header",null,r.a.createElement(f.a,{variant:"h5"},"Register")),r.a.createElement(Y.a,{id:"username",label:"Username",variant:"outlined",className:c.field,required:!0,value:s,onChange:function(e){var t=e.target;return u(t.value)}}),r.a.createElement(Y.a,{id:"password",label:"Password",type:"password",variant:"outlined",className:c.field,required:!0,value:g,onChange:function(e){var t=e.target;return h(t.value)}}),r.a.createElement($e.a,{control:r.a.createElement(et.a,{id:"admin",size:"medium",checked:b,onChange:function(e){var t=e.target;return O(t.checked)},color:"primary"}),label:"is Admin?"}),t?r.a.createElement(K.a,null):r.a.createElement(B.a,{variant:"contained",type:"submit",disabled:t,color:"primary"},"Sign up"),r.a.createElement("footer",null,r.a.createElement(f.a,{variant:"subtitle2"},"Already have account with us? ",r.a.createElement(o.b,{to:"/app"},"Sign in"))))},nt=Object(s.a)((function(){return{signUpCtr:{margin:"10em auto",maxWidth:"32em"}}})),rt=function(e){var t=e.signingUp,a=e.signUpFailure,n=nt(),c=!t&&a;return r.a.createElement(Z,null,r.a.createElement("section",{className:n.signUpCtr},c&&r.a.createElement(m.a,{severity:"error"},a),r.a.createElement("br",null),r.a.createElement(u.a,{elevation:2},r.a.createElement(at,{isSubmitting:t,onSubmit:function(e){var t=e.username,a=e.password,n=e.admin;V(t.value,a.value,n.checked)}}))))},ct=Object(s.a)((function(){return{container:{margin:"10em auto",maxWidth:"32em"}}})),it=function(e){var t=ct();return r.a.createElement(Z,null,r.a.createElement("section",{className:t.container},r.a.createElement(f.a,{variant:"h2",color:"secondary"},"Sorry..."),r.a.createElement("br",null),r.a.createElement(f.a,{variant:"h5"},e.message),r.a.createElement("br",null),r.a.createElement(B.a,{href:"/app",size:"large",variant:"outlined",color:"primary"},"Log in")))},ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return{}};return function(t){return function(a){var c=Object(n.useContext)(vt);Object(n.useEffect)((function(){console.log("REMOUNTING....")}),[]);var i=e&&e(c);return r.a.createElement(t,Object.assign({},i,a,{dispatch:Et.dispatch}))}}},lt=ot((function(e){return{loggingIn:e.login.loading,loginSuccess:e.login.payload,loginFailure:e.login.error,signingUp:e.signUp.loading,signUpSuccess:e.signUp.payload,loggingOut:e.logout.loading,logoutSuccess:e.logout.payload}}))((function(e){var t=Object(l.g)(),a=e.loggingIn,c=e.loginSuccess;return Object(n.useEffect)((function(){console.log("REMOUNTING LOGIN....")}),[]),Object(n.useEffect)((function(){!a&&c&&t.push("/app/home")}),[a,c]),r.a.createElement($,e)})),st={skanda:{username:"skanda",lastVisited:(new Date).toString(),admin:!0},murthy:{username:"murthy",lastVisited:(new Date).toString(),admin:!1},hussain:{username:"hussain",lastVisited:(new Date).toString(),admin:!1},deepak:{username:"deepak",lastVisited:(new Date).toString(),admin:!0},sandeep:{username:"sandeep",lastVisited:(new Date).toString(),admin:!1}},ut=ot((function(e){return{activeUsers:Object.values(Object(G.a)({},e.activeUsers.payload,{},st)),loggedInUser:e.login.payload&&e.login.payload.user}}))(Ze),mt=[{isAdmin:!0,username:"akash",createdOn:"2020-04-11T13:52:45.930Z",lastVisited:"2020-04-12T16:18:44.859Z"},{isAdmin:!1,username:"amruth",createdOn:"2020-04-11T14:24:41.310Z",lastVisited:"2020-04-12T17:32:32.484Z"},{isAdmin:!0,username:"skanda",createdOn:"2020-04-12T08:46:03.513Z",lastVisited:"2020-04-12T08:46:18.867Z"}],pt=ot((function(e){return{users:mt}}))((function(e){return Object(n.useEffect)((function(){z()}),[]),r.a.createElement(Xe,e)})),dt=ot((function(e){return{signingUp:e.signUp.loading,signUpSuccess:e.signUp.payload,signUpFailure:e.signUp.error}}))((function(e){var t=Object(l.g)(),a=e.signingUp,c=e.signUpSuccess,i=e.dispatch;return Object(n.useEffect)((function(){!a&&c&&(t.push("/app"),setTimeout((function(){return i({type:"app/auth/SIGN_UP_RESET"})}),3e3))}),[a,c]),r.a.createElement(rt,e)})),gt=function(e){return r.a.createElement(it,Object.assign({message:"Invalid session. Please login again!"},e))},ft={loading:!1,payload:null,error:!1},ht={loading:!1,payload:null,error:!1},Et=function(e){var t,a=[],n=function(n){t=e(t,n),console.info("My Store updated: ",t),a.forEach((function(e){return e()}))};return n({}),{getState:function(){return t},subscribe:function(e){return a.push(e),a.filter((function(t){return e!==t}))},dispatch:n}}((Be={login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object(G.a)({},e,{loading:!0,error:!1});case"app/auth/LOGIN_SUCCESS":return Object(G.a)({},e,{loading:!1,payload:t.payload,error:!1});case"app/auth/LOGIN_FAILURE":return Object(G.a)({},e,{loading:!1,error:!0});case w:case"app/auth/LOGIN_RESET":return Object(G.a)({},ft);default:return e}},signUp:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(G.a)({},e,{loading:!0,error:!1});case I:return Object(G.a)({},e,{loading:!1,payload:t.payload,error:!1});case _:return Object(G.a)({},e,{loading:!1,error:t.payload});case N:case"app/auth/SIGN_UP_RESET":return Object(G.a)({},ft);default:return e}},logout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"app/auth/LOGOUT_PENDING":return Object(G.a)({},e,{loading:!0,error:!1});case"app/auth/LOGOUT_SUCCESS":return Object(G.a)({},e,{loading:!1,payload:!0,error:!1});case"app/auth/LOGOUT_FAILURE":return Object(G.a)({},e,{loading:!1,error:!0});case N:return Object(G.a)({},ft);default:return e}},activeUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ht,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"app/auth/FETCH_ACTIVE_USERS_PENDING":return Object(G.a)({},e,{loading:!0,error:!1});case"app/auth/FETCH_ACTIVE_USERS_SUCCESS":return Object(G.a)({},e,{loading:!1,payload:t.payload});case"app/auth/FETCH_ACTIVE_USERS_FAILURE":return Object(G.a)({},e,{loading:!1,error:!0});default:return e}},userHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ht,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"app/auth/FETCH_USER_HISTORY_PENDING":return Object(G.a)({},e,{loading:!0,error:!1});case"app/auth/FETCH_USER_HISTORY_SUCCESS":return Object(G.a)({},e,{loading:!1,payload:t.payload});default:return e}}},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object.keys(Be).reduce((function(a,n){return a[n]=Be[n](e[n],t),a}),{})})),vt=r.a.createContext(),bt=function(){return r.a.createElement(vt.Provider,{value:Et.getState()},r.a.createElement(o.a,null,r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/",exact:!0,render:function(){return r.a.createElement(l.a,{to:"/app"})}}),r.a.createElement(l.b,{path:"/app",exact:!0,component:lt}),r.a.createElement(l.b,{path:"/app/register",component:dt}),r.a.createElement(l.b,{path:"/app/home",component:ut}),r.a.createElement(l.b,{path:"/app/history",component:pt}),r.a.createElement(l.b,{path:"/app/error",component:gt}),r.a.createElement(l.b,{render:function(){return r.a.createElement(gt,{message:"Looking for the App? Login below to get started"})}}))))},Ot=function(){return i.a.render(r.a.createElement(bt,null),document.getElementById("root"))};Et.subscribe(Ot),Ot()}},[[175,1,2]]]);
//# sourceMappingURL=main.901586dd.chunk.js.map